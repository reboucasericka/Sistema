@model Sistema.Models.Admin.CreateAppointmentViewModel
@{
    ViewData["Title"] = "Novo Agendamento";
    Layout = "_PainelLayout";
}

<div class="container py-4">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card shadow">
                <div class="card-header bg-primary text-white">
                    <h4 class="mb-0">
                        <i class="fas fa-calendar-plus me-2"></i>
                        Novo Agendamento
                    </h4>
                </div>
                <div class="card-body">
                    <form asp-action="NewAppointment" method="post">
                        <div asp-validation-summary="ModelOnly" class="alert alert-danger"></div>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label asp-for="ServiceId" class="form-label">
                                    <i class="fas fa-spa me-2" style="color: var(--accent-terracotta);"></i>
                                    Serviço
                                </label>
                                <select asp-for="ServiceId" class="form-select" asp-items="@(new SelectList(ViewBag.Services, "Id", "Name"))">
                                    <option value="">Selecione um serviço</option>
                                </select>
                                <span asp-validation-for="ServiceId" class="text-danger"></span>
                            </div>

                            <div class="col-md-6 mb-3">
                                <label asp-for="ProfessionalId" class="form-label">
                                    <i class="fas fa-user-md me-2" style="color: var(--accent-terracotta);"></i>
                                    Profissional
                                </label>
                                <select asp-for="ProfessionalId" class="form-select" asp-items="@(new SelectList(ViewBag.Professionals, "ProfessionalId", "Name"))">
                                    <option value="">Selecione um profissional</option>
                                </select>
                                <span asp-validation-for="ProfessionalId" class="text-danger"></span>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label asp-for="Date" class="form-label">
                                    <i class="fas fa-calendar me-2" style="color: var(--accent-terracotta);"></i>
                                    Data
                                </label>
                                <input asp-for="Date" type="date" class="form-control" min="@DateTime.Today.ToString("yyyy-MM-dd")" />
                                <span asp-validation-for="Date" class="text-danger"></span>
                            </div>

                            <div class="col-md-6 mb-3">
                                <label asp-for="Time" class="form-label">
                                    <i class="fas fa-clock me-2" style="color: var(--accent-terracotta);"></i>
                                    Horário
                                </label>
                                <input asp-for="Time" type="time" class="form-control" />
                                <span asp-validation-for="Time" class="text-danger"></span>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label asp-for="Notes" class="form-label">
                                <i class="fas fa-sticky-note me-2" style="color: var(--accent-terracotta);"></i>
                                Observações (opcional)
                            </label>
                            <textarea asp-for="Notes" class="form-control" rows="3" placeholder="Alguma observação especial para o seu agendamento..."></textarea>
                            <span asp-validation-for="Notes" class="text-danger"></span>
                        </div>

                        <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                            <a asp-action="Profile" class="btn btn-outline-secondary me-md-2">
                                <i class="fas fa-arrow-left me-2"></i>
                                Voltar
                            </a>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-calendar-check me-2"></i>
                                Agendar
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Informações sobre o processo -->
            <div class="card mt-4">
                <div class="card-body">
                    <h5 class="card-title">
                        <i class="fas fa-info-circle me-2" style="color: var(--accent-terracotta);"></i>
                        Como funciona?
                    </h5>
                    <div class="row">
                        <div class="col-md-4 text-center">
                            <div class="mb-3">
                                <i class="fas fa-calendar-plus fa-2x" style="color: var(--accent-terracotta);"></i>
                            </div>
                            <h6>1. Agende</h6>
                            <p class="text-muted">Escolha o serviço, profissional, data e horário desejados.</p>
                        </div>
                        <div class="col-md-4 text-center">
                            <div class="mb-3">
                                <i class="fas fa-clock fa-2x" style="color: var(--secondary-olive);"></i>
                            </div>
                            <h6>2. Aguarde</h6>
                            <p class="text-muted">Seu agendamento ficará pendente até ser confirmado.</p>
                        </div>
                        <div class="col-md-4 text-center">
                            <div class="mb-3">
                                <i class="fas fa-check-circle fa-2x" style="color: var(--accent-peach);"></i>
                            </div>
                            <h6>3. Confirme</h6>
                            <p class="text-muted">Confirme seu agendamento quando solicitado.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
    
    <script>
        // Adicionar animação aos campos
        document.querySelectorAll('.form-control, .form-select').forEach(input => {
            input.addEventListener('focus', function() {
                this.parentElement.style.transform = 'scale(1.02)';
            });
            
            input.addEventListener('blur', function() {
                this.parentElement.style.transform = 'scale(1)';
            });
        });

        // Validação da data (não permitir datas passadas)
        document.querySelector('input[name="Date"]').addEventListener('change', function() {
            const selectedDate = new Date(this.value);
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            if (selectedDate < today) {
                alert('Por favor, selecione uma data futura.');
                this.value = '';
            }
        });
    </script>
}
