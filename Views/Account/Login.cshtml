@model Sistema.Models.Account.LoginViewModel
@{
    ViewData["Title"] = "Login";
    Layout = "_AuthLayout";
}
<!--Views/Account/Login.cshtml-->
<div class="container-fluid min-vh-100 d-flex align-items-center">
    <div class="row w-100">
        <!-- Imagem esquerda -->
        <div class="col-md-6 auth-image d-none d-md-flex align-items-center justify-content-center">
            <div class="auth-image-content">
                <h3>Bem-vinda de volta!</h3>
                <p>Entre na sua conta e continue sua jornada de beleza conosco.</p>
                <div class="mt-4">
                    <i class="fas fa-spa fa-3x mb-3" style="opacity: 0.8;"></i>
                </div>
            </div>
        </div>

        <!-- Formulário direita -->
        <div class="col-md-6 d-flex align-items-center justify-content-center p-4">
            <div class="auth-card w-100" style="max-width: 450px;">
                <div class="auth-header">
                    <h2><i class="fas fa-sign-in-alt me-2"></i>Entrar</h2>
                    <p>Acesse sua conta para continuar</p>
                </div>

                <div class="p-4">
                    <form asp-controller="Account" asp-action="Login" method="post">
                        @Html.AntiForgeryToken()
                        <input type="hidden" name="returnUrl" value="@ViewData["ReturnUrl"]" />

                        <div class="mb-3">
                            <label asp-for="Username" class="form-label">
                                <i class="fas fa-user me-2" style="color: var(--accent-terracotta);"></i>
                                E-mail ou Username
                            </label>
                            <input asp-for="Username" class="form-control" />
                            <span asp-validation-for="Username" class="text-danger"></span>
                        </div>

                        <div class="mb-3">
                            <label asp-for="Password">Senha</label>
                            <div class="position-relative">
                                <input asp-for="Password" type="password" class="form-control" />
                                <span asp-validation-for="Password" class="text-warning"></span>                            
                        </div>
                        </div>
                        <div>
                            <div class="form-check mb-3">
                                <input asp-for="RememberMe" type="checkbox" class="form-check-input" />
                                <label asp-for="RememberMe" class="form-check-label">Lembrar de mim</label>
                            </div>
                            <span asp-validation-for="RememberMe" class="text-warning"></span>
                        </div>
                        <div class="mb-3">
                            <input type="submit" value="Login" class="btn btn-success" />
                            <a asp-action="Register" class="btn btn-primary">Register New User</a>
                        </div>

                        <!-- Login Social -->
                        <div class="social-login">
                            <div class="divider">
                                <span>ou continue com</span>
                            </div>
                            <a asp-action="ExternalLogin" asp-route-provider="Facebook" asp-route-returnUrl="@Context.Request.Query["returnUrl"]" class="btn btn-facebook social-btn">
                                <i class="fab fa-facebook-f me-2"></i>
                                Facebook
                            </a>
                            <a asp-action="ExternalLogin" asp-route-provider="Google" asp-route-returnUrl="@Context.Request.Query["returnUrl"]" class="btn btn-google social-btn">
                                <i class="fab fa-google me-2"></i>
                                Google
                            </a>
                        </div>
                        <!--REDIRECIONA PARA O REGISTER-->
                        <div class="text-center">
                            <p class="mb-2">Não tem uma conta?</p>
                            <a asp-action="Register" class="text-link"><i class="fas fa-user-plus me-1"></i>Cadastre-se aqui</a>
                        </div>

                        <!--engrenagem acesso administrativo-->
                        <div class="text-center mt-3">
                            <a asp-controller="Account" asp-action="AdminLogin" title="Acesso Administrativo"
                               style="font-size: 1.5rem; color: var(--cor-detalhe); text-decoration: none;">
                                <i class="fas fa-cog"></i>
                            </a>
                            <p class="small text-muted mt-2"></p>
                        </div>

                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }

    <script>
        function togglePassword() {
            const passwordInput = document.querySelector('input[name="Password"]');
            const toggleIcon = document.getElementById('toggleIcon');

            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                toggleIcon.classList.remove('fa-eye');
                toggleIcon.classList.add('fa-eye-slash');
            } else {
                passwordInput.type = 'password';
                toggleIcon.classList.remove('fa-eye-slash');
                toggleIcon.classList.add('fa-eye');
            }
        }

        // Funções de autenticação social já implementadas via links

        // Adicionar animação aos campos
        document.querySelectorAll('.form-control').forEach(input => {
            input.addEventListener('focus', function() {
                this.parentElement.style.transform = 'scale(1.02)';
            });

            input.addEventListener('blur', function() {
                this.parentElement.style.transform = 'scale(1)';
            });
        });
    </script>

    <script>
        // Limpar cache e storage ao carregar a página
        document.addEventListener('DOMContentLoaded', function() {
            // Limpar storage
            try {
                localStorage.clear();
                sessionStorage.clear();
            } catch (e) {
                // console.log('Storage clear failed:', e);
            }

            // Limpar cache se disponível
            if ('caches' in window) {
                caches.keys().then(function(names) {
                    names.forEach(function(name) {
                        caches.delete(name);
                    });
                }).catch(function(e) {
                    // console.log('Cache clear failed:', e);
                });
            }
        });
    </script>
}